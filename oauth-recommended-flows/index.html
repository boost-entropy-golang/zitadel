<!doctype html> <html class="theme-default typo-default" lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#159794 name=theme-color> <base href=/ > <link href=prism.css rel=stylesheet> <link href=manifest.json rel=manifest> <link href=icons/favicon.ico rel=icon type=image/x-icon> <link href=https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css rel=stylesheet> <link href=default-skin/default-skin.css rel=stylesheet> <link href=photoswipe.css rel=stylesheet> <script src=photoswipe.min.js></script> <script src=photoswipe-ui-default.min.js></script> <link href="https://fonts.googleapis.com/css2?family=Lato&display=swap" rel=stylesheet> <link href=client/client-48e31998.css rel=stylesheet><link href=client/[slug]-f0764356.css rel=stylesheet> <style>.hljs,.hljs-subst{color:#e8eaed}.hljs-comment{color:#999}.hljs-tag{color:#f8b886}.hljs-keyword{color:#ff2069}.hljs-attr{color:#a3acb9}.hljs-number{color:#f8b886}.hljs-deletion,.hljs-quote,.hljs-selector-class,.hljs-selector-id,.hljs-string,.hljs-template-tag,.hljs-type{color:#1ea672}.hljs-section,.hljs-title{color:#1ea672}.hljs-literal{color:#f8b886}.hljs-meta{color:#e8eaed}.hljs-meta-string{color:#e8eaed}</style> <title>ZITADEL Documentation • oauth-recommended-flows</title> <link href=/client/client.cf423e37.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/client-48e31998.css rel=preload as=style><link href=/client/[slug].a855549f.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/inject_styles.5607aec6.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/[slug]-f0764356.css rel=preload as=style></head> <body> <div id=sapper> <header class="svelte-1h17ogk visible"><nav class=svelte-1h17ogk><a href=. class="svelte-1h17ogk home" title="Zitadel docs" sapper:prefetch><img alt="Zitadel docs" src=logos/zitadel-logo-light.svg class=svelte-1h17ogk> <span class="svelte-1h17ogk docs">DOCS</span></a> <span class="svelte-1h17ogk fill-space"></span> <ul class="svelte-1h17ogk primary"><li><a href=start sapper:prefetch><i class="las la-bars bars"></i>Get started</a></li> <li><a href=quickstarts sapper:prefetch><i class="las la-bars bars"></i>Quickstarts</a></li> <li><a href=guides sapper:prefetch><i class="las la-bars bars"></i>Guides</a></li> <li><a href=apis sapper:prefetch><i class="las la-bars bars"></i>APIs</a></li> <li><a href=architecture sapper:prefetch><i class="las la-bars bars"></i>Architecture</a></li> <li><a href=use sapper:prefetch><i class="las la-bars bars"></i>Manual</a></ul> <span class="svelte-1h17ogk fill-space show-if-desktop"></span> <a href=https://console.zitadel.ch class="svelte-1h17ogk show-if-desktop"><button class=svelte-1h17ogk><span class=svelte-1h17ogk>LOGIN</span></button></a></nav></header> <main class=svelte-ke1jp4> <div class="svelte-him5z6 content listify"><section class=svelte-him5z6 data-id=Recommended_authorization_flows><h2 class=svelte-him5z6><span class=offset-anchor id=Recommended_authorization_flows></span> <a href=oauth-recommended-flows#Recommended_authorization_flows class=anchor aria-hidden></a> Recommended authorization flows <small class=svelte-him5z6><a href=https://github.com/caos/zitadel/edit/master/site/docs/oauth-recommended-flows/00-oauth-recommended-flows.md class=svelte-him5z6 title="edit this section"><i class="las la-external-link-alt" style=font-size:24px;height:24px><use xlink:href="#las la-external-link-alt"></use></i></a> </small></h2> <div class=table-wrapper> <table> <thead> <tr> <th></th> <th></th> </tr> </thead> <tr> <td>Description</td> <td>Learn about the different authentication flows and which flow we recommend you should use for your application.</td> </tr> <tr> <td>Learning Outcomes</td> <td>In this module you will: <ul><li>Learn the basics of federated identities<li>Understand the basics of OAuth 2.x client profiles and their importance for authorization flows<li>Get a recommended flow for Web, Native, User-Agent, and API</ul></td> </tr> <tr> <td>Prerequisites</td> <td>Basic knowledge about federated identities.</td> </tr> </table> </div> <h3> <span class=offset-anchor id=Introduction></span> <a href=oauth-recommended-flows#Introduction class=anchor aria-hidden=true><i class="las la-link"></i></a> Introduction </h3><p>Before we get into setting up our first application within ZITADEL, we need to go through some basics on how to obtain an authorization with OpenID Connect 1.x and OAuth 2.x. </p> <p>ZITADEL does not make assumptions about the application type you are about to integrate. Therefore you must qualify and define an appropriate method for your users to gain authorization to access your application (“authentication flow”). Your choice depends on the application’s ability to maintain the confidentiality of client credentials and the technological capabilities of your application. If you choose a deprecated or unfeasible flow to obtain authorization for your application, your users’ credentials may be compromised.</p> <p>We invite you to further explore the different authorization flows in the OAuth 2.x standard. For the start we assume that you have a brand-new application (ie. without legacy requirements) and you found an reliable SDK/Library that does the heavy lifting for you. </p> <p>So this module will only go over the basics and explain why we recommend the flow “Authorization Flow with PKCE” as default for most applications. We will also cover the case of machine-to-machine communication, ie. where there is no interactive login. Further we will guide you to further reading viable alternatives, if the default flow is not feasible.</p> <h3> <span class=offset-anchor id=Basics_of_Federated_Identity></span> <a href=oauth-recommended-flows#Basics_of_Federated_Identity class=anchor aria-hidden=true><i class="las la-link"></i></a> Basics of Federated Identity </h3><p>Although Federated Identities are not a new concept (<a href=https://tools.ietf.org/html/rfc6749 target=_blank>RFC 6749</a>, “The OAuth 2.0 Authorization Framework” was released in 2012) it is important to highlight the difference between the traditional client-server authentication model and the concept of delegated authorization and authentication.</p> <p>The aforementioned RFC provides us with some <a href=https://tools.ietf.org/html/rfc6749#section-1 target=_blank>problems and limitations</a> of the client-server authentication, where a client requests a protected resource on the server by authenticating with the user’s credentials:</p> <ul> <li>Applications need to store users credentials (eg, password) for future use; compromise of any application results in compromise of the end-users credentials</li> <li>Servers are required to support password authentication</li> <li>Without means of limiting scope when providing the user’s credentials, the application gains overly broad access to protected resources</li> <li>Users cannot revoke access for a single application, but only for all by changing credentials</li> </ul> <p>So what do we want to achieve with delegated authentication?</p> <ul> <li>Instead of implementing authentication on each server and trusting each server: <ul> <li>Users only <strong>authenticate</strong> with a trusted server (ie. ZITADEL), that validates the user’s identity through a challenge (eg, multiple authentication factors) and issues an <strong>ID token</strong> (OpenID Connect 1.x)</li> <li>Applications have means of <strong>validating the integrity</strong> of presented access and ID tokens</li> </ul> </li> <li>Instead of sending around the user’s credentials: <ul> <li>Clients may access protected resources with an <strong>access token</strong> that is only valid for specific scope and limited lifetime (OAuth 2.x)</li> <li>Users have to <strong>authorize</strong> applications to access certain <a href=https://docs.zitadel.ch/architecture#Scopes target=_blank><strong>scopes</strong></a> (eg, email address or custom roles). Applications can request <a href=https://docs.zitadel.ch/architecture#Claims target=_blank><strong>claims</strong></a> (key:value pairs, eg email address) for the authorized scopes with the access token or ID token from ZITADEL</li> <li>Access tokens are bearer tokens, meaning that possession of the token provides access to a resource. But the tokens expire frequently and the application must request a new access token via <strong>refresh token</strong> or the user must reauthenticate</li> </ul> </li> </ul> <div class=zitadel-gallery itemscope itemtype=http://schema.org/ImageGallery> <figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject> <a href=img/consulting_federated_identities_basics.png data-size=1920x1080 itemprop=contentUrl> <img alt=consulting_federated_identities_basics src=img/consulting_federated_identities_basics.png itemprop=thumbnail> </a> <figcaption itemprop="caption description">Overview federated identities</figcaption> </figure> </div> <p>This is where the so-called “flows” come into play: There are a number of different flows on how to handle the process from authentication, over authorization, getting tokens and requesting additional information about the user.</p> <p>Maybe interesting to mention is that we are mostly concerned with choosing the right OAuth 2.x flows (alas “authorization”). OpenID Connect extends the OAuth 2.x flow with useful features like endpoint discovery (where to ask), ID Token (who is the user, when and how did she authenticate), and UserInfo Endpoint (getting additional information about the user).</p> <h3> <span class=offset-anchor id=Different_client_profiles></span> <a href=oauth-recommended-flows#Different_client_profiles class=anchor aria-hidden=true><i class="las la-link"></i></a> Different client profiles </h3><p>As mentioned in the beginning of this module, there are two main determinants for choosing the optimal authorization flow: </p> <ol> <li>Client’s ability to maintain the confidentiality of client credentials</li> <li>Technological limitations</li> </ol> <p>OAuth 2.x defines two <a href=https://tools.ietf.org/html/rfc6749#section-2.1 target=_blank>client types</a> based on their ability to maintain the confidentiality of their client credentials:</p> <ul> <li>Confidential: Clients capable of maintaining the confidentiality of their credentials (e.g., client implemented on a secure server with restricted access to the client credentials), or capable of secure client authentication using other means.</li> <li>Public: Clients incapable of maintaining the confidentiality of their credentials (e.g., clients executing on the device used by the resource owner, such as an installed native application or a web browser-based application), and incapable of secure client authentication via any other means.</li> </ul> <p>The following table gives you a brief overview of different client profiles.</p> <table class=table-wrapper> <tr> <th>Confidentiality of client credentials</th> <th>Client profile</th> <th>Examples of clients</th> <tr> <tr> <td rowspan=2>Public</td> <td>User-Agent</td> <td>Single-page web applications (SPA), generally JavaScript executed in Browser</td> </tr> <tr> <td>Native</td> <td>Native, Mobile, or Desktop applications</td> </tr> <tr> <td rowspan=2>Confidential</td> <td>Web</td> <td>Server-side web applications such as java, .net, …</td> </tr> <tr> <td>Machine-to-Machine</td> <td>APIs, generally services without direct user-interaction at the authorization server</td> </tr> </table> <h3> <span class=offset-anchor id=Our_recommended_authorization_flows></span> <a href=oauth-recommended-flows#Our_recommended_authorization_flows class=anchor aria-hidden=true><i class="las la-link"></i></a> Our recommended authorization flows </h3><p>We recommend using the flow <strong>“Authorization Code with Proof Key of Code Exchange (PKCE)”</strong> (<a href=https://tools.ietf.org/html/rfc7636 target=_blank>RFC7636</a>) for <strong>User-Agent</strong>, <strong>Native</strong>, and <strong>Web</strong> clients.</p> <p>If you don’t have any technical limitations, you should favor the flow Authorization Code with PKCE over other methods. The PKCE part makes the flow resistant against authorization code interception attack as described well in RFC7636.</p> <p><em>So what about APIs?</em></p> <p>We recommend using <strong>“JWT bearer token with private key”</strong> (<a href=https://tools.ietf.org/html/rfc7523 target=_blank>RFC7523</a>) for Machine-to-Machine clients. </p> <p>What this means is that you have to send an JWT token, containing the <a href=https://docs.zitadel.ch/architecture#Claims target=_blank>standard claims for access tokens</a> and that is signed with your private key, to the token endpoint to request the access token. We will see how this works in another module about Service Accounts.</p> <p>If you don’t have any technical limitations, you should prefer this method over other methods.</p> <p>A JWT with a private key can also be used with client profile web to further enhance security.</p> <p>In case you need alternative flows and their advantages and drawbacks, there will be a module to outline more methods and our recommended fallback strategy per client profile that are available in ZITADEL.</p> <h3> <span class=offset-anchor id=Knowledge_Check_3></span> <a href=oauth-recommended-flows#Knowledge_Check_3 class=anchor aria-hidden=true><i class="las la-link"></i></a> Knowledge Check (3) </h3><ul> <li>With federated identities the user sends credentials to the server holding the protected resource<ul> <li><input disabled type=checkbox> yes</li> <li><input disabled type=checkbox> no</li> </ul> </li> <li>ZITADEL will discover your client profile automatically and set the correct flow<ul> <li><input disabled type=checkbox> yes</li> <li><input disabled type=checkbox> no</li> </ul> </li> <li>When working with APIs / machine-to-machine communication its recommended to exchange a JWT that is singed with your private key for an access token<ul> <li><input disabled type=checkbox> yes</li> <li><input disabled type=checkbox> no</li> </ul> </li> </ul> <details> <summary> Solutions </summary> <ul> <li>With federated identities the user sends credentials to the server holding the protected resource<ul> <li><input disabled type=checkbox> yes</li> <li><input disabled type=checkbox checked> no (Users are authenticated against a centralized IDP, only access tokens are send to the requested resources)</li> </ul> </li> <li>ZITADEL will discover your client profile automatically and set the correct flow<ul> <li><input disabled type=checkbox> yes</li> <li><input disabled type=checkbox checked> no (ZITADEL does not make any assumptions about your application’s requirements)</li> </ul> </li> <li>When working with APIs / machine-to-machine communication its recommended to exchange a JWT that is singed with your private key for an access token<ul> <li><input disabled type=checkbox checked> yes</li> <li><input disabled type=checkbox> no</li> </ul> </li> </ul> </details> <h3> <span class=offset-anchor id=Summary_3></span> <a href=oauth-recommended-flows#Summary_3 class=anchor aria-hidden=true><i class="las la-link"></i></a> Summary (3) </h3><ul> <li>Federated Identities solve key problems and challenges with traditional server-client architecture</li> <li>Use “Authorization Code with Proof Key of Code Exchange (PKCE)” for User-Agent, Native, and Web clients</li> <li>“JWT bearer token with private key” for Machine-to-Machine clients</li> <li>There are alternative flows and fallback strategies supported by ZITADEL, if these flows are technically not possible</li> </ul> <p>Where to go from here</p> <ul> <li>ZITADEL Applications</li> <li>ZITADEL Service Accounts</li> <li>Alternative authentication flows (aka. "The Zoo")</li> </ul> </section></div> <div class="svelte-him5z6 overlay"></div> <aside class="svelte-him5z6 sidebar-container"><div class="svelte-him5z6 sidebar"><button class="svelte-5en90e search-trigger"><i class="las la-search svelte-5en90e"></i> <span class=svelte-5en90e>Search this site</span> <span class="svelte-5en90e fill-space"></span> <span class="svelte-5en90e strg">Ctrl F</span></button> <ul class="svelte-7kfwfv reference-toc"><li class=svelte-7kfwfv><a href=oauth-recommended-flows#Recommended_authorization_flows class="svelte-7kfwfv section">Recommended authorization flows </a> <a href=oauth-recommended-flows#Introduction class="svelte-7kfwfv subsection" data-level=3>Introduction </a> <a href=oauth-recommended-flows#Basics_of_Federated_Identity class="svelte-7kfwfv subsection" data-level=3>Basics of Federated Identity </a> <a href=oauth-recommended-flows#Different_client_profiles class="svelte-7kfwfv subsection" data-level=3>Different client profiles </a> <a href=oauth-recommended-flows#Our_recommended_authorization_flows class="svelte-7kfwfv subsection" data-level=3>Our recommended authorization flows </a> <a href=oauth-recommended-flows#Knowledge_Check_3 class="svelte-7kfwfv subsection" data-level=3>Knowledge Check (3) </a> <a href=oauth-recommended-flows#Summary_3 class="svelte-7kfwfv subsection" data-level=3>Summary (3) </a> </ul></div> <button class=svelte-him5z6><i class="las la-bars" style=font-size:20px;height:20px><use xlink:href="#las la-bars"></use></i></button></aside> </main> <div class=pswp aria-hidden=true role=dialog tabindex=-1> <div class=pswp__bg></div> <div class=pswp__scroll-wrap> <div class=pswp__container><div class=pswp__item></div> <div class=pswp__item></div> <div class=pswp__item></div></div> <div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar> <div class=pswp__counter></div> <button class="pswp__button pswp__button--close" title="Close (Esc)"></button> <button class="pswp__button pswp__button--share" title=Share></button> <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button> <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button> <div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div> <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button> <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button> <div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div></div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,(function(a,b){return {sections:[{html:"\u003Cdiv class=\"table-wrapper\"\u003E\n\u003Ctable\u003E\n\u003Cthead\u003E\n\u003Ctr\u003E\n\u003Cth\u003E\u003C\u002Fth\u003E\n\u003Cth\u003E\u003C\u002Fth\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Fthead\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\n\u003Ctd\u003EDescription\u003C\u002Ftd\u003E\n\u003Ctd\u003ELearn about the different authentication flows and which flow we recommend you should use for your application.\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003ELearning Outcomes\u003C\u002Ftd\u003E\n\u003Ctd\u003EIn this module you will: \u003Cul\u003E\u003Cli\u003ELearn the basics of federated identities\u003C\u002Fli\u003E\u003Cli\u003EUnderstand the basics of OAuth 2.x client profiles and their importance for authorization flows\u003C\u002Fli\u003E\u003Cli\u003EGet a recommended flow for Web, Native, User-Agent, and API\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003EPrerequisites\u003C\u002Ftd\u003E\n\u003Ctd\u003EBasic knowledge about federated identities.\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Ftbody\u003E\u003C\u002Ftable\u003E\n\u003C\u002Fdiv\u003E\n\t\t\t\t\t\u003Ch3\u003E\n\t\t\t\t\t\t\u003Cspan id=\"Introduction\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"oauth-recommended-flows#Introduction\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003Ci class=\"las la-link\"\u003E\u003C\u002Fi\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\tIntroduction\n\t\t\t\t\t\u003C\u002Fh3\u003E\u003Cp\u003EBefore we get into setting up our first application within ZITADEL, we need to go through some basics on how to obtain an authorization with OpenID Connect 1.x and OAuth 2.x. \u003C\u002Fp\u003E\n\u003Cp\u003EZITADEL does not make assumptions about the application type you are about to integrate. Therefore you must qualify and define an appropriate method for your users to gain authorization to access your application (“authentication flow”). Your choice depends on the application’s ability to maintain the confidentiality of client credentials and the technological capabilities of your application. If you choose a deprecated or unfeasible flow to obtain authorization for your application, your users’ credentials may be compromised.\u003C\u002Fp\u003E\n\u003Cp\u003EWe invite you to further explore the different authorization flows in the OAuth 2.x standard. For the start we assume that you have a brand-new application (ie. without legacy requirements) and you found an reliable SDK\u002FLibrary that does the heavy lifting for you. \u003C\u002Fp\u003E\n\u003Cp\u003ESo this module will only go over the basics and explain why we recommend the flow “Authorization Flow with PKCE” as default for most applications. We will also cover the case of machine-to-machine communication, ie. where there is no interactive login. Further we will guide you to further reading viable alternatives, if the default flow is not feasible.\u003C\u002Fp\u003E\n\n\t\t\t\t\t\u003Ch3\u003E\n\t\t\t\t\t\t\u003Cspan id=\"Basics_of_Federated_Identity\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"oauth-recommended-flows#Basics_of_Federated_Identity\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003Ci class=\"las la-link\"\u003E\u003C\u002Fi\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\tBasics of Federated Identity\n\t\t\t\t\t\u003C\u002Fh3\u003E\u003Cp\u003EAlthough Federated Identities are not a new concept (\u003Ca href=\"https:\u002F\u002Ftools.ietf.org\u002Fhtml\u002Frfc6749\" target=\"_blank\"\u003ERFC 6749\u003C\u002Fa\u003E, “The OAuth 2.0 Authorization Framework” was released in 2012) it is important to highlight the difference between the traditional client-server authentication model and the concept of delegated authorization and authentication.\u003C\u002Fp\u003E\n\u003Cp\u003EThe aforementioned RFC provides us with some \u003Ca href=\"https:\u002F\u002Ftools.ietf.org\u002Fhtml\u002Frfc6749#section-1\" target=\"_blank\"\u003Eproblems and limitations\u003C\u002Fa\u003E of the client-server authentication, where a client requests a protected resource on the server by authenticating with the user’s credentials:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EApplications need to store users credentials (eg, password) for future use; compromise of any application results in compromise of the end-users credentials\u003C\u002Fli\u003E\n\u003Cli\u003EServers are required to support password authentication\u003C\u002Fli\u003E\n\u003Cli\u003EWithout means of limiting scope when providing the user’s credentials, the application gains overly broad access to protected resources\u003C\u002Fli\u003E\n\u003Cli\u003EUsers cannot revoke access for a single application, but only for all by changing credentials\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003ESo what do we want to achieve with delegated authentication?\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EInstead of implementing authentication on each server and trusting each server: \u003Cul\u003E\n\u003Cli\u003EUsers only \u003Cstrong\u003Eauthenticate\u003C\u002Fstrong\u003E with a trusted server (ie. ZITADEL), that validates the user’s identity through a challenge (eg, multiple authentication factors) and issues an \u003Cstrong\u003EID token\u003C\u002Fstrong\u003E (OpenID Connect 1.x)\u003C\u002Fli\u003E\n\u003Cli\u003EApplications have means of \u003Cstrong\u003Evalidating the integrity\u003C\u002Fstrong\u003E of presented access and ID tokens\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003EInstead of sending around the user’s credentials: \u003Cul\u003E\n\u003Cli\u003EClients may access protected resources with an \u003Cstrong\u003Eaccess token\u003C\u002Fstrong\u003E that is only valid for specific scope and limited lifetime (OAuth 2.x)\u003C\u002Fli\u003E\n\u003Cli\u003EUsers have to \u003Cstrong\u003Eauthorize\u003C\u002Fstrong\u003E applications to access certain \u003Ca href=\"https:\u002F\u002Fdocs.zitadel.ch\u002Farchitecture#Scopes\" target=\"_blank\"\u003E\u003Cstrong\u003Escopes\u003C\u002Fstrong\u003E\u003C\u002Fa\u003E (eg, email address or custom roles). Applications can request \u003Ca href=\"https:\u002F\u002Fdocs.zitadel.ch\u002Farchitecture#Claims\" target=\"_blank\"\u003E\u003Cstrong\u003Eclaims\u003C\u002Fstrong\u003E\u003C\u002Fa\u003E (key:value pairs, eg email address) for the authorized scopes with the access token or ID token from ZITADEL\u003C\u002Fli\u003E\n\u003Cli\u003EAccess tokens are bearer tokens, meaning that possession of the token provides access to a resource. But the tokens expire frequently and the application must request a new access token via \u003Cstrong\u003Erefresh token\u003C\u002Fstrong\u003E or the user must reauthenticate\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cdiv class=\"zitadel-gallery\" itemscope itemtype=\"http:\u002F\u002Fschema.org\u002FImageGallery\"\u003E\n    \u003Cfigure itemprop=\"associatedMedia\" itemscope itemtype=\"http:\u002F\u002Fschema.org\u002FImageObject\"\u003E\n        \u003Ca href=\"img\u002Fconsulting_federated_identities_basics.png\" itemprop=\"contentUrl\" data-size=\"1920x1080\"\u003E\n            \u003Cimg src=\"img\u002Fconsulting_federated_identities_basics.png\" itemprop=\"thumbnail\" alt=\"consulting_federated_identities_basics\" \u002F\u003E\n        \u003C\u002Fa\u003E\n        \u003Cfigcaption itemprop=\"caption description\"\u003EOverview federated identities\u003C\u002Ffigcaption\u003E\n    \u003C\u002Ffigure\u003E\n\u003C\u002Fdiv\u003E\n\n\u003Cp\u003EThis is where the so-called “flows” come into play: There are a number of different flows on how to handle the process from authentication, over authorization, getting tokens and requesting additional information about the user.\u003C\u002Fp\u003E\n\u003Cp\u003EMaybe interesting to mention is that we are mostly concerned with choosing the right OAuth 2.x flows (alas “authorization”). OpenID Connect extends the OAuth 2.x flow with useful features like endpoint discovery (where to ask), ID Token (who is the user, when and how did she authenticate), and UserInfo Endpoint (getting additional information about the user).\u003C\u002Fp\u003E\n\n\t\t\t\t\t\u003Ch3\u003E\n\t\t\t\t\t\t\u003Cspan id=\"Different_client_profiles\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"oauth-recommended-flows#Different_client_profiles\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003Ci class=\"las la-link\"\u003E\u003C\u002Fi\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\tDifferent client profiles\n\t\t\t\t\t\u003C\u002Fh3\u003E\u003Cp\u003EAs mentioned in the beginning of this module, there are two main determinants for choosing the optimal authorization flow: \u003C\u002Fp\u003E\n\u003Col\u003E\n\u003Cli\u003EClient’s ability to maintain the confidentiality of client credentials\u003C\u002Fli\u003E\n\u003Cli\u003ETechnological limitations\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cp\u003EOAuth 2.x defines two \u003Ca href=\"https:\u002F\u002Ftools.ietf.org\u002Fhtml\u002Frfc6749#section-2.1\" target=\"_blank\"\u003Eclient types\u003C\u002Fa\u003E based on their ability to maintain the confidentiality of their client credentials:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EConfidential: Clients capable of maintaining the confidentiality of their credentials (e.g., client implemented on a secure server with restricted access to the client credentials), or capable of secure client authentication using other means.\u003C\u002Fli\u003E\n\u003Cli\u003EPublic: Clients incapable of maintaining the confidentiality of their credentials (e.g., clients executing on the device used by the resource owner, such as an installed native application or a web browser-based application), and incapable of secure client authentication via any other means.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EThe following table gives you a brief overview of different client profiles.\u003C\u002Fp\u003E\n\u003Ctable class=\"table-wrapper\"\u003E\n    \u003Ctr\u003E\n        \u003Cth\u003EConfidentiality of client credentials\u003C\u002Fth\u003E\n        \u003Cth\u003EClient profile\u003C\u002Fth\u003E\n        \u003Cth\u003EExamples of clients\u003C\u002Fth\u003E\n    \u003Ctr\u003E\n    \u003Ctr\u003E\n        \u003Ctd rowspan=\"2\"\u003EPublic\u003C\u002Ftd\u003E\n        \u003Ctd\u003EUser-Agent\u003C\u002Ftd\u003E\n        \u003Ctd\u003ESingle-page web applications (SPA), generally JavaScript executed in Browser\u003C\u002Ftd\u003E\n    \u003C\u002Ftr\u003E\n    \u003Ctr\u003E\n        \u003Ctd\u003ENative\u003C\u002Ftd\u003E\n        \u003Ctd\u003ENative, Mobile, or Desktop applications\u003C\u002Ftd\u003E\n    \u003C\u002Ftr\u003E\n    \u003Ctr\u003E\n        \u003Ctd rowspan=\"2\"\u003EConfidential\u003C\u002Ftd\u003E\n        \u003Ctd\u003EWeb\u003C\u002Ftd\u003E\n        \u003Ctd\u003EServer-side web applications such as java, .net, …\u003C\u002Ftd\u003E\n    \u003C\u002Ftr\u003E\n    \u003Ctr\u003E\n        \u003Ctd\u003EMachine-to-Machine\u003C\u002Ftd\u003E\n        \u003Ctd\u003EAPIs, generally services without direct user-interaction at the authorization server\u003C\u002Ftd\u003E\n    \u003C\u002Ftr\u003E\n\u003C\u002Ftable\u003E\n\n\n\t\t\t\t\t\u003Ch3\u003E\n\t\t\t\t\t\t\u003Cspan id=\"Our_recommended_authorization_flows\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"oauth-recommended-flows#Our_recommended_authorization_flows\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003Ci class=\"las la-link\"\u003E\u003C\u002Fi\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\tOur recommended authorization flows\n\t\t\t\t\t\u003C\u002Fh3\u003E\u003Cp\u003EWe recommend using the flow \u003Cstrong\u003E“Authorization Code with Proof Key of Code Exchange (PKCE)”\u003C\u002Fstrong\u003E (\u003Ca href=\"https:\u002F\u002Ftools.ietf.org\u002Fhtml\u002Frfc7636\" target=\"_blank\"\u003ERFC7636\u003C\u002Fa\u003E) for \u003Cstrong\u003EUser-Agent\u003C\u002Fstrong\u003E, \u003Cstrong\u003ENative\u003C\u002Fstrong\u003E, and \u003Cstrong\u003EWeb\u003C\u002Fstrong\u003E clients.\u003C\u002Fp\u003E\n\u003Cp\u003EIf you don’t have any technical limitations, you should favor the flow Authorization Code with PKCE over other methods. The PKCE part makes the flow resistant against authorization code interception attack as described well in RFC7636.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cem\u003ESo what about APIs?\u003C\u002Fem\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EWe recommend using \u003Cstrong\u003E“JWT bearer token with private key”\u003C\u002Fstrong\u003E (\u003Ca href=\"https:\u002F\u002Ftools.ietf.org\u002Fhtml\u002Frfc7523\" target=\"_blank\"\u003ERFC7523\u003C\u002Fa\u003E) for Machine-to-Machine clients. \u003C\u002Fp\u003E\n\u003Cp\u003EWhat this means is that you have to send an JWT token, containing the \u003Ca href=\"https:\u002F\u002Fdocs.zitadel.ch\u002Farchitecture#Claims\" target=\"_blank\"\u003Estandard claims for access tokens\u003C\u002Fa\u003E and that is signed with your private key, to the token endpoint to request the access token. We will see how this works in another module about Service Accounts.\u003C\u002Fp\u003E\n\u003Cp\u003EIf you don’t have any technical limitations, you should prefer this method over other methods.\u003C\u002Fp\u003E\n\u003Cp\u003EA JWT with a private key can also be used with client profile web to further enhance security.\u003C\u002Fp\u003E\n\u003Cp\u003EIn case you need alternative flows and their advantages and drawbacks, there will be a module to outline more methods and our recommended fallback strategy per client profile that are available in ZITADEL.\u003C\u002Fp\u003E\n\n\t\t\t\t\t\u003Ch3\u003E\n\t\t\t\t\t\t\u003Cspan id=\"Knowledge_Check_3\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"oauth-recommended-flows#Knowledge_Check_3\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003Ci class=\"las la-link\"\u003E\u003C\u002Fi\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\tKnowledge Check (3)\n\t\t\t\t\t\u003C\u002Fh3\u003E\u003Cul\u003E\n\u003Cli\u003EWith federated identities the user sends credentials to the server holding the protected resource\u003Cul\u003E\n\u003Cli\u003E\u003Cinput disabled=\"\" type=\"checkbox\"\u003E yes\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cinput disabled=\"\" type=\"checkbox\"\u003E no\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003EZITADEL will discover your client profile automatically and set the correct flow\u003Cul\u003E\n\u003Cli\u003E\u003Cinput disabled=\"\" type=\"checkbox\"\u003E yes\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cinput disabled=\"\" type=\"checkbox\"\u003E no\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003EWhen working with APIs \u002F machine-to-machine communication its recommended to exchange a JWT that is singed with your private key for an access token\u003Cul\u003E\n\u003Cli\u003E\u003Cinput disabled=\"\" type=\"checkbox\"\u003E yes\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cinput disabled=\"\" type=\"checkbox\"\u003E no\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cdetails\u003E\n    \u003Csummary\u003E\n        Solutions\n    \u003C\u002Fsummary\u003E\n\n\u003Cul\u003E\n\u003Cli\u003EWith federated identities the user sends credentials to the server holding the protected resource\u003Cul\u003E\n\u003Cli\u003E\u003Cinput disabled=\"\" type=\"checkbox\"\u003E yes\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003E no (Users are authenticated against a centralized IDP, only access tokens are send to the requested resources)\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003EZITADEL will discover your client profile automatically and set the correct flow\u003Cul\u003E\n\u003Cli\u003E\u003Cinput disabled=\"\" type=\"checkbox\"\u003E yes\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003E no (ZITADEL does not make any assumptions about your application’s requirements)\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003EWhen working with APIs \u002F machine-to-machine communication its recommended to exchange a JWT that is singed with your private key for an access token\u003Cul\u003E\n\u003Cli\u003E\u003Cinput checked=\"\" disabled=\"\" type=\"checkbox\"\u003E yes\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cinput disabled=\"\" type=\"checkbox\"\u003E no\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fdetails\u003E\n\n\n\t\t\t\t\t\u003Ch3\u003E\n\t\t\t\t\t\t\u003Cspan id=\"Summary_3\" class=\"offset-anchor\" \u003E\u003C\u002Fspan\u003E\n\t\t\t\t\t\t\u003Ca href=\"oauth-recommended-flows#Summary_3\" class=\"anchor\" aria-hidden=\"true\"\u003E\u003Ci class=\"las la-link\"\u003E\u003C\u002Fi\u003E\u003C\u002Fa\u003E\n\t\t\t\t\t\tSummary (3)\n\t\t\t\t\t\u003C\u002Fh3\u003E\u003Cul\u003E\n\u003Cli\u003EFederated Identities solve key problems and challenges with traditional server-client architecture\u003C\u002Fli\u003E\n\u003Cli\u003EUse “Authorization Code with Proof Key of Code Exchange (PKCE)” for User-Agent, Native, and Web clients\u003C\u002Fli\u003E\n\u003Cli\u003E“JWT bearer token with private key” for Machine-to-Machine clients\u003C\u002Fli\u003E\n\u003Cli\u003EThere are alternative flows and fallback strategies supported by ZITADEL, if these flows are technically not possible\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EWhere to go from here\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EZITADEL Applications\u003C\u002Fli\u003E\n\u003Cli\u003EZITADEL Service Accounts\u003C\u002Fli\u003E\n\u003Cli\u003EAlternative authentication flows (aka. &quot;The Zoo&quot;)\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n",metadata:{title:"Recommended authorization flows",tags:"beginner, developer",readingtime:"15min"},subsections:[{slug:b,title:b,level:a},{slug:"Basics_of_Federated_Identity",title:"Basics of Federated Identity",level:a},{slug:"Different_client_profiles",title:"Different client profiles",level:a},{slug:"Our_recommended_authorization_flows",title:"Our recommended authorization flows",level:a},{slug:"Knowledge_Check_3",title:"Knowledge Check (3)",level:a},{slug:"Summary_3",title:"Summary (3)",level:a}],slug:"Recommended_authorization_flows",file:"00-oauth-recommended-flows.md"}],seo:"",slug:"oauth-recommended-flows"}}(3,"Introduction"))]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');(function(){try{eval("async function x(){}");var main="/client/client.cf423e37.js"}catch(e){main="/client/legacy/client.dd68c871.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@2.0.5.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> 